<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>DNA k-mer Counter (Flask)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <style>
      body { font-family: Arial, sans-serif; line-height: 1.5; margin: 24px; }
      textarea { width: 100%; font-family: Consolas, monospace; }
      .container { max-width: 900px; margin: auto; }
      table { border-collapse: collapse; width: 100%; margin-top: 12px; }
      th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
      th { background: #f5f5f5; }
      .row { display: flex; gap: 12px; align-items: center; }
      .row input[type="number"] { width: 80px; }
      .summary { margin-top: 12px; }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>DNA k-mer Counter (Flask)</h2>

      <form method="post">
        <label for="dna">DNA sequence</label><br>
        <textarea id="dna" name="dna" rows="6" placeholder="ACGT..."></textarea><br><br>

        <div class="row">
          <label for="k">k</label>
          <input id="k" type="number" name="k" min="1" max="6" value="2">
          <button type="submit">Analyze</button>
        </div>
        <p><small>Tip: k=1 counts bases, k=2 counts dinucleotides, k=3 counts trimers.</small></p>
      </form>

      {% if result %}
        <div class="summary">
          {% if result.total is defined %}
            <p><strong>Total k-mers:</strong> {{ result.total }}</p>
          {% elif result["total"] is defined %}
            <p><strong>Total k-mers:</strong> {{ result["total"] }}</p>
          {% endif %}
        </div>

        {# Option A: if you passed pairs=sorted(counts.items()) from app.py #}
        {% if pairs is defined %}
          <table>
            <tr><th>k-mer</th><th>count</th></tr>
            {% for kmer, cnt in pairs %}
              <tr><td>{{ kmer }}</td><td>{{ cnt }}</td></tr>
            {% endfor %}
          </table>

        {# Option B: if result is a dict of kmer->count (iterate method must be called) #}
        {% elif result.items is defined %}
          <table>
            <tr><th>k-mer</th><th>count</th></tr>
            {% for kmer, cnt in result.items() %}
              {# skip non-kmer metadata keys if present #}
              {% if kmer|length >= 1 and kmer|length <= 10 and kmer is string %}
                <tr><td>{{ kmer }}</td><td>{{ cnt }}</td></tr>
              {% endif %}
            {% endfor %}
          </table>

        {# Option C: if result has a key "items" containing iterable of (kmer,cnt) #}
        {% elif result.items is not defined and result["items"] is defined %}
          <table>
            <tr><th>k-mer</th><th>count</th></tr>
            {% for kmer, cnt in result["items"] %}
              <tr><td>{{ kmer }}</td><td>{{ cnt }}</td></tr>
            {% endfor %}
          </table>
        {% endif %}
      {% endif %}
    </div>
  </body>
</html>
